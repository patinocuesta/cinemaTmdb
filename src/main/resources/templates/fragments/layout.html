<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:fragment="head">
        <title>CinemaSpring</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <script src="/webjars/tinymce/4.7.9/tinymce.min.js"></script>
        <link rel="stylesheet" href="/webjars/bootstrap/3.3.7-1/css/bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="/static/css/style.css" th:href="@{/static/css/style.css}"/>
    </div>
</head>
<body id="myPage" data-spy="scroll" data-target=".navbar" data-offset="50">
<div th:fragment="navbar">
    <nav class="navbar navbar-inverse navbar-fixed-top" id="mainNav">
        <div class="container-fluid" STYLE="max-width: 1000px; margin: auto;">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">Spring Cinema</a>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#"><span class="glyphicon glyphicon-user"></span> Sign Up</a></li>
                    <li><a href="#"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
                </ul>
                <ul class="nav navbar-nav">
                    <li><a href="#">A l'affiche</a></li>
                    <li><a href="#">Evenements</a></li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Explorer
                            <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">Films</a></li>
                            <li><a href="#">Acteurs</a></li>
                            <li><a href="#">Realisateurs</a></li>
                            <li><a href="#">Genres</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">Nos distributeurs
                            <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a th:href="@{'tmdb/list/1'}" th:text="Importer">Importer</a></li>
                        </ul>
                    </li>
                    <li class="dropdown">
                        <a class="dropdown-toggle" data-toggle="dropdown" href="#">NÃ´tre cinema
                            <span class="caret"></span></a>
                        <ul class="dropdown-menu">
                            <li><a href="#">blog</a></li>
                            <li><a href="#">Nous trouver</a></li>
                            <li><a href="#">Contact</a></li>
                            <li><a href="#">A propos de nous</a></li>
                        </ul>
                    </li>
                </ul>

            </div>
            <nav class="classnavbar navbar-inverse" id="importSearch">
                <div class="search-container">
                    <form class="example" action="/action_page.php">
                        <input type="text" placeholder="Search.." name="search">
                    </form>
                </div>
            </nav>
    </nav>

</div>
<div th:fragment="overlay">
    <!--Overside-->
    <div id="overSide" class="overlay">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav();">&times;</a>
        <!--overlay Content-->
        <div class="overlay-content">
            <!--Container fluid-->
            <div class="container-fluid text-center">

                <!-- row -->
                <div class="row content" STYLE="max-width: 1000px; margin: auto;" ;>
                    <div class="col-sm-6 col-md-4 col-lg-4 sidenav">
                        <img src="" alt="Avatar" class="affiche_overlay" id="poster_path">
                        <a href="" class="importbtn" onclick="closeNav()">Importer</a>
                        <br/>
                    </div>
                    <!-- Texto izquierda -->
                    <div class="col-sm-6 col-md-8 col-lg-8 text-left">
                        <div class="well">
                            <div class="film-title" id="film-title"></div>
                        </div>
                        <!--Panel Rating-->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                Rating
                            </div>
                            <div class="panel-body">
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star checked"></span>
                                <span class="fa fa-star"></span>
                                <span class="fa fa-star"></span>
                            </div>
                        </div>
                        <!--Fin Rating-->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                Sinopsis
                            </div>
                            <div class="panel-body" id="overview">
                            </div>
                        </div>
                        <!--Panel genres-->
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                genres
                            </div>
                            <div class="panel-body" id="genres">
                                temis
                            </div>
                            <!--Fin Panel genres-->
                        </div>
                        <!--Panel Equipo artistico-->
                        <div class="panel panel-default" id="cast">
                            <div class="panel-heading">
                                Equipe artistique
                            </div>
                            <div class="panel-body" id="panel-body-cast">
                                <!--Panel actor-->
                                <div class="panel panel-default">
                                    <div class="panel-heading">
                                        Nom acteur
                                    </div>
                                    <div class="panel-body">
                                        <img src="https://image.tmdb.org/t/p/w600_and_h900_bestv2/bPqRdLWWwpOT8sBdj9PWOzNgwou.jpg"
                                             alt="Avatar" class="image_overlay">
                                    </div>
                                    <div class="panel-footer">
                                        Role
                                    </div>

                                </div>
                                <!--Fin actor-->
                            </div>

                        </div>
                        <!--Fin Equipo artistico-->
                        <!--Fin texto izq-->
                    </div>
                    <!--Fin row-->
                </div>
                <!--Fin Container fluid-->
            </div>
            <!--Fin overalay content-->
        </div>
        <!--Fin Overside-->
    </div>
</div>
<div th:fragment="container-films">
    <div class="container-fluid text-center" id="container-films">
        <div class="row" id="row-films">
            <div class="col-xs-6 col-sm-3 col-md-3" th:each="film: ${films.listFilmDto}" id="col-films">
                <div class="panel panel-default" id="filmpanel">
                    <div class="panel-body">
                        <div class="container">
                            <img th:src="@{'https://image.tmdb.org/t/p/w500/'+ ${film.poster_path}}" alt="Avatar"
                                 class="image" id="poster_path">
                            <div class="middle">
                                <button type="button" class="btn btn-primary btn-md" onclick="openNav(this.id)"
                                        th:id="${film.id}">Voir details
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div th:fragment="pagination">
    <div class="row">
        <ul class="pagination pagination-lg">
            <li th:each="i : ${#numbers.sequence(1,films.total_pages)}">
                <a href="" th:text="${i}" th:id="${i}" onclick="pgNav(this.id);return false;">1</a>
                <!-- <a th:href="@{${i}}" th:text="${i}" th:id="${i}"  onclick ="pgNav()">1</a>  -->

            </li>

        </ul>

    </div>
</div>
</div>
<div th:fragment="footer">

    <footer class="text-center">

        <a class="up-arrow" href="#myPage" data-toggle="tooltip" title="TO TOP">
            <span class="glyphicon glyphicon-chevron-up"></span>
        </a><br><br>
        <p>Bootstrap Theme Made By <a href="#" data-toggle="tooltip" title="Visit w3schools">Spring cinema</a></p>
    </footer>
</div>
<div th:fragment="footer-js">
    <script src="/webjars/bootstrap/3.3.7-1/js/bootstrap.min.js"></script>
    <script src="/webjars/jquery/3.3.1/jquery.js"></script>


    <!-- Placed at the end of the document so the pages load faster -->

    <script>
        $('.ui.dropdown.item')
            .dropdown();
    </script>
    <script>

        function pgNav(clicked_id) {
            $("#row-films").empty();
            $.ajax({
                url: '/api/tmdb/list/' + clicked_id,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                data: 'data',
                success: function (data) {
                    for (var i = 0; i < data.listFilmDto.length; i++) {
                        $("#row-films").append(
                            '<div class="col-xs-6 col-sm-3 col-md-3" id="col-films">' +
                            '<div class="panel panel-default">' +
                            '<div class="panel-body">' +
                            '<div class="container" >' +
                            '<img src="https://image.tmdb.org/t/p/w500/' + data.listFilmDto[i].poster_path + '" alt="Avatar" class="image" id="poster_path">' +
                            '<div class="middle">' +
                            '<button type="button" class="btn btn-primary btn-md" onclick="openNav(this.id)" id="' + data.listFilmDto[i].id + '">Details du film </button>' +
                            '</div>' +
                            '</div>' +
                            '</div>' +
                            '</div>' +
                            '</div>'
                        );
                    }
                }
            })

        }


    </script>
    <script>
        function openNav(clicked_id) {
            $('#film-title').empty();
            $('#overview').empty();
            document.getElementById("poster_path").src = '';
            $("#panel-body-cast").empty();

            $.ajax({
                url: '/api/tmdb/list/film/' + clicked_id,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                data: 'data',
                success: function (data) {

                    var filmTitle = data.title;
                    var overview = data.overview;
                    var poster_path = data.poster_path;
                    var genresList = "";
                    var genres = data.genres;
                    var cast = data.credits.cast;
                    var crew = data.credits.crew;


                    for (var i = 0; i < data.genres.length; i++) {
                        genresList += " " + genres[i].name;
                    }

                    $('#genres').html(genresList);
                    $('#film-title').html(filmTitle);
                    $('#overview').html(overview);
                    document.getElementById("poster_path").src = 'https://image.tmdb.org/t/p/w500/' + poster_path;

                    for (var i = 0; i< 4; i++){
                        $("#panel-body-cast").append(
                            '<div class="col-xs-6 col-sm-6 col-md-3" id="col-artist">' +
                            '<div class="panel panel-default">' +
                            '<div class="panel-heading">' +
                            cast[i].name +
                            '</div>' +
                            '<div class="panel-body">' +
                            '<img src="https://image.tmdb.org/t/p/w500/' + cast[i].profile_path + '" '+
                            'alt="Avatar" class="image_overlay">' +
                            '</div>' +
                            '<div class="panel-footer">' +
                            'Role:' + cast[i].character +
                            '</div>' +
                            '</div>' +
                            '</div>'



                        );
                    }


                }


            });
            document.getElementById("overSide").style.width = "100%";
            document.getElementById("mainNav").style.display = "none";
        }

        function closeNav() {
            document.getElementById("overSide").style.width = "0%";
            document.getElementById("mainNav").style.display = "block";
            $('#film-title').empty();
            $('#overview').empty();
            document.getElementById("poster_path").src = '';
            $("#panel-body-cast").empty();

        }

    </script>
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        })
    </script>


</div>
</body>
</html>

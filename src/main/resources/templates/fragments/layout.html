<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:fragment="head">
        <title>CinemaSpring</title>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <script src="/webjars/tinymce/4.7.9/tinymce.min.js"></script>
        <link rel="stylesheet" href="/webjars/bootstrap/3.3.7-1/css/bootstrap.min.css"/>
        <link rel="stylesheet" type="text/css" href="/static/css/style.css" th:href="@{/static/css/style.css}"/>
        <link rel="stylesheet" type="text/css" href="/static/css/navbar.css" th:href="@{/static/css/navbar.css}"/>
        <link rel="stylesheet" type="text/css" href="/static/css/listfilms.css" th:href="@{/static/css/listfilms.css}"/>
        <link rel="stylesheet" type="text/css" href="/static/css/pagination.css" th:href="@{/static/css/pagination.css}"/>


    </div>
</head>
<body>



<div th:fragment="pagination">
    <div class="row">
        <ul class="pagination pagination-lg">
            <li th:each="i : ${#numbers.sequence(1,films.total_pages)}">
                <a href="" th:text="${i}" th:id="${i}" onclick="pgNav(this.id);return false;">1</a>
                <!-- <a th:href="@{${i}}" th:text="${i}" th:id="${i}"  onclick ="pgNav()">1</a>  -->

            </li>

        </ul>

    </div>
</div>
</div>
<div th:fragment="footer">

    <footer class="text-center">

        <a class="up-arrow" href="#myPage" data-toggle="tooltip" title="TO TOP">
            <span class="glyphicon glyphicon-chevron-up"></span>
        </a><br><br>
        <p>Bootstrap Theme Made By <a href="#" data-toggle="tooltip" title="Visit w3schools">Spring cinema</a></p>
    </footer>
</div>
<div th:fragment="footer-js">
    <script src="/webjars/bootstrap/3.3.7-1/js/bootstrap.min.js"></script>
    <script src="/webjars/jquery/3.3.1/jquery.js"></script>


    <!-- Placed at the end of the document so the pages load faster -->

    <script>
        $('.ui.dropdown.item')
            .dropdown();
    </script>
    <script>

        function pgNav(clicked_id) {
            $("#row-films").empty();
            $.ajax({
                url: '/api/tmdb/list/' + clicked_id,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                data: 'data',
                success: function (data) {
                    for (var i = 0; i < data.listFilmDto.length; i++) {
                        $("#row-films").append(
                            '<div class="col-xs-6 col-sm-3 col-md-3" id="col-films">' +
                            '<div class="panel panel-default">' +
                            '<div class="panel-body">' +
                            '<div class="container" >' +
                            '<img src="https://image.tmdb.org/t/p/w500/' + data.listFilmDto[i].poster_path + '" alt="Avatar" class="image" id="poster_path">' +
                            '<div class="middle">' +
                            '<button type="button" class="btn btn-primary btn-md" onclick="openNav(this.id)" id="' + data.listFilmDto[i].id + '">Details du film </button>' +
                            '</div>' +
                            '</div>' +
                            '</div>' +
                            '</div>' +
                            '</div>'
                        );
                    }
                }
            })

        }


    </script>
    <script>
        function openNav(clicked_id) {
            $('#film-title').empty();
            $('#overview').empty();
            document.getElementById("poster_path").src = '';
            $("#panel-body-cast").empty();

            $.ajax({
                url: '/api/tmdb/list/film/' + clicked_id,
                type: 'get',
                dataType: 'json',
                contentType: 'application/json',
                data: 'data',
                success: function (data) {

                    var filmTitle = data.title;
                    var overview = data.overview;
                    var poster_path = data.poster_path;
                    var genresList = "";
                    var genres = data.genres;
                    var cast = data.credits.cast;
                    var crew = data.credits.crew;


                    for (var i = 0; i < data.genres.length; i++) {
                        genresList += " " + genres[i].name;
                    }

                    $('#genres').html(genresList);
                    $('#film-title').html(filmTitle);
                    $('#overview').html(overview);
                    document.getElementById("poster_path").src = 'https://image.tmdb.org/t/p/w500/' + poster_path;

                    for (var i = 0; i< 4; i++){
                        $("#panel-body-cast").append(
                            '<div class="col-xs-6 col-sm-6 col-md-3" id="col-artist">' +
                            '<div class="panel panel-default">' +
                            '<div class="panel-heading">' +
                            cast[i].name +
                            '</div>' +
                            '<div class="panel-body">' +
                            '<img src="https://image.tmdb.org/t/p/w500/' + cast[i].profile_path + '" '+
                            'alt="Avatar" class="image_overlay">' +
                            '</div>' +
                            '<div class="panel-footer">' +
                            'Role:' + cast[i].character +
                            '</div>' +
                            '</div>' +
                            '</div>'

                        );
                    }


                }


            });
            document.getElementById("overSide").style.width = "100%";
            document.getElementById("mainNav").style.display = "none";
        }

        function closeNav() {
            document.getElementById("overSide").style.width = "0%";
            document.getElementById("mainNav").style.display = "block";
            $('#film-title').empty();
            $('#overview').empty();
            document.getElementById("poster_path").src = '';
            $("#panel-body-cast").empty();

        }

    </script>
    <script>
        $(document).ready(function () {
            $('[data-toggle="tooltip"]').tooltip();
        })
    </script>


</div>
</body>
</html>
